{% extends 'base.html.twig' %}

{% block javascripts %}
    {{parent()}}
    <script src="{{ asset('js/ajaxgrid.js') }}" type="text/javascript"></script>
{% endblock %}

{% block body %}
<!--start-breadcrumbs-->
<div class="breadcrumbs">
    <div class="container">
        <div class="breadcrumbs-main">
            <ol class="breadcrumb">
                <li><a href="{{ path('homepage') }}">Home</a></li>
                <li class="active">List of products</li>
            </ol>
        </div>
    </div>
</div>
<!--end-breadcrumbs-->
<div class="product">
    <div class="container">
        <div class="account-top heading">
            <h2>User list</h2>
        </div>
        <div id="entities-grid"></div>
        <div class="pagenatin">
            <nav>
                {{ knp_pagination_render(pagination) }}
            </nav>
        </div>
        <script type="text/javascript">
            var settings= {
                'dataURL':'http://127.0.0.1:8000/user/ajax?sortbyfield=id&order=asc&filterbyfield=name&pattern=',
                'sortbyfield': 'id',
                'order': 'asc',
                'filterbyfield': '',
                'pattern': '',
                'page': '1'
            };
            document.addEventListener("DOMContentLoaded", function() {
                $("#entities-grid").ajaxGrid('update',{
                    'dataURL':settings.dataURL,
                    'sortableColumns':'[“id”]',
                    'filterableColumns':'[“username”]'
                })
            });
            $("#entities-grid").on("keyup",".filter",function () {
                settings.filterbyfield=this.parentElement.id;
                settings.pattern=this.value;
                settings.dataURL=generateURL();
                console.log(settings);
                $("#entities-grid").ajaxGrid('update',{'dataURL':settings.dataURL});
            });
            $("#entities-grid").on("click",".sort",function () {
                settings.sortbyfield=this.parentElement.id;
                if(settings.order=="asc"){settings.order="desc"}
                else {settings.order="asc"}
                settings.dataURL=generateURL();
                console.log(settings);
                $("#entities-grid").ajaxGrid('update',{'dataURL':settings.dataURL});
            });
            function next() {
                //...
            }
            function previous() {
                //...
            }
            function generateURL(){
                return "http://127.0.0.1:8000/user/ajax?sortbyfield="+settings.sortbyfield+"&order="+settings.order+
                        "&filterbyfield="+settings.filterbyfield+"&pattern="+settings.pattern+"&page="+settings.page;
            }
        </script>
    </div>
</div>
{% endblock %}
